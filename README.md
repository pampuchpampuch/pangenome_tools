# Pangenome models exploratory project
Master thesis project with a goal of finding out how different pangenome models correspond to each other and how they could be improved:
1. What are the similarities and differences
2. Do they complement each other or contradict?
3. Is joinded analysis possible and what insight could it bring?

This project includes models manipulation and developement of metrics that allow for models comparison. Exploratory analysis of data represented in those models could bring valuable insight allowing for models' improvement and developement of new construction methods as well as pangenome data visualization.

For now, models that are considered in the analysis are:
- variation graphs
- whole genome alignement
- model generated by [Panaroo pipeline](https://github.com/gtonkinhill/panaroo)

  # Pangenome class
  Pangenome class is an abstract class extended as needed to classes such as Panaroo, MAF or GFA.
  An object of corresponding classes can be obtained by using `maf_parser.parse_MAF()`, `panaroo_parser.parse_panaroo_output()` or `gfa_parser.parse_gfa1()` functions.
  
  Pangenome class allows for operations such as:
  1. Filtering by sequence names
  2. Aligning synteny blocks (using MAFFT) (`Pangenome.to_MAF()`)
  3. Getting basic statistics
  4. Mapping sequences to GFF files (`Pangenome.map_to_GFF()`)
  5. Converting between different coordination systems (0 or 1 based start, half open or fully closed end) (`Pangenome.convert_coords_system()`)
  6. Constructing a cluster graph based on Panaroo criteria (`Pangenome.get_cluster_graph()`)
  7. Work in progress approach: extracting triplets representing strukctural variants (`Pangenome.get_panaroo_cluster_triplets()`)
  8. Writing to GFF (allows for incorporating BEDtools into analyses (`Pangenome.to_gff()`) - important note - in the last field of GFF record information about synteny block affiliation is saved, so infromation about general structure of original model is not lost.
  
  # Inputs preparation
  Some simple but usefull tools (most based on Panaroo input gff catalogs) include:
  1. Constructing gappy block with first posistions of all contigs in the dataset (can be used to trick _mafComparator_ to include sequences existing in only one of the fiels in the computed statistics) (`gff_to_all_scaffs_block.py`)
  2. Writing gff file representing all contigs in the datasets (`all_scaffs_to_gff.py`) - useful for comparing models to input data with _BEDtools_.
  
